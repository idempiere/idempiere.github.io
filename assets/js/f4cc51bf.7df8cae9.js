"use strict";(self.webpackChunkidempiere_id_github_io=self.webpackChunkidempiere_id_github_io||[]).push([[6161],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>k});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,i=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=s(n),c=l,k=d["".concat(p,".").concat(c)]||d[c]||u[c]||i;return n?a.createElement(k,r(r({ref:t},m),{},{components:n})):a.createElement(k,r({ref:t},m))}));function k(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=n.length,r=new Array(i);r[0]=c;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o[d]="string"==typeof e?e:l,r[1]=o;for(var s=2;s<i;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8094:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>s});var a=n(7462),l=(n(7294),n(3905));const i={title:"Automatic External Pack In",sidebar_label:"Automatic External Pack In",description:"Automatically install 2Pack files at startup across tenants using a shared folder and naming conventions.",sidebar_position:7},r="\u2699\ufe0f Automatic External Pack In",o={unversionedId:"basic-development/plugin-development/automatic-external-packin",id:"basic-development/plugin-development/automatic-external-packin",title:"Automatic External Pack In",description:"Automatically install 2Pack files at startup across tenants using a shared folder and naming conventions.",source:"@site/docs/basic-development/plugin-development/automatic-external-packin.md",sourceDirName:"basic-development/plugin-development",slug:"/basic-development/plugin-development/automatic-external-packin",permalink:"/docs/basic-development/plugin-development/automatic-external-packin",draft:!1,editUrl:"https://github.com/idempiere/idempiere.github.io/tree/main/docs/basic-development/plugin-development/automatic-external-packin.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Automatic External Pack In",sidebar_label:"Automatic External Pack In",description:"Automatically install 2Pack files at startup across tenants using a shared folder and naming conventions.",sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"2Pack - Transfer & Automate",permalink:"/docs/basic-development/plugin-development/packin-packout-guide"},next:{title:"Basic Primers",permalink:"/docs/category/basic-primers"}},p={},s=[{value:"\ud83d\udcdd Background",id:"-background",level:2},{value:"Automatic External Pack In",id:"automatic-external-pack-in",level:2},{value:"\ud83d\udd01 Automatic on Server Restart",id:"-automatic-on-server-restart",level:3},{value:"\ud83e\udde9 ZIP File Naming Convention",id:"-zip-file-naming-convention",level:3},{value:"Naming Components",id:"naming-components",level:4},{value:"ClientValue Options",id:"clientvalue-options",level:4},{value:"\ud83d\udce6 Examples",id:"-examples",level:3},{value:"Seed Client Explained",id:"seed-client-explained",level:3},{value:"Flow Summary",id:"flow-summary",level:2},{value:"Email Notifications",id:"email-notifications",level:2},{value:"\ud83d\udcda References",id:"-references",level:2}],m={toc:s},d="wrapper";function u(e){let{components:t,...n}=e;return(0,l.kt)(d,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"\ufe0f-automatic-external-pack-in"},"\u2699\ufe0f Automatic External Pack In"),(0,l.kt)("p",null,"This feature allows 2Pack files to be installed automatically at server startup from an external folder\u2014without requiring them to be embedded in a plug-in."),(0,l.kt)("h2",{id:"-background"},"\ud83d\udcdd Background"),(0,l.kt)("p",null,"iDempiere supports several ways to install 2Packs from within plug-ins:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"AdempiereActivator"),": Installs ",(0,l.kt)("inlineCode",{parentName:"li"},"META-INF/2Pack.zip")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Version2PackActivator"),": Installs multiple files ",(0,l.kt)("inlineCode",{parentName:"li"},"META-INF/2Pack_[version].zip")," up to the plug-in version"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Incremental2PackActivator"),": Installs ",(0,l.kt)("strong",{parentName:"li"},"all")," ",(0,l.kt)("inlineCode",{parentName:"li"},"META-INF/2Pack_[version].zip")," files regardless of plug-in version")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Limitations of these approaches:")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Only work when a plug-in is present  "),(0,l.kt)("li",{parentName:"ol"},"Only install data on the ",(0,l.kt)("strong",{parentName:"li"},"System")," client  ")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"automatic-external-pack-in"},"Automatic External Pack In"),(0,l.kt)("p",null,"To overcome the limitations above, the ",(0,l.kt)("strong",{parentName:"p"},"Automatic External Pack In")," mechanism was introduced."),(0,l.kt)("h3",{id:"-automatic-on-server-restart"},"\ud83d\udd01 Automatic on Server Restart"),(0,l.kt)("p",null,"This is driven by several ",(0,l.kt)("strong",{parentName:"p"},"SysConfig")," keys:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Key"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTOMATIC_PACKIN_FOLDERS")),(0,l.kt)("td",{parentName:"tr",align:null},"Folder(s) to scan for ",(0,l.kt)("inlineCode",{parentName:"td"},".zip")," files (semicolon ",(0,l.kt)("inlineCode",{parentName:"td"},";")," separated)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTOMATIC_PACKIN_INITIAL_DELAY")),(0,l.kt)("td",{parentName:"tr",align:null},"Time in seconds that org.adempiere.plugin.utils waits before starting to process the AUTOMATIC_PACKIN_FOLDERS, this is useful in order to wait for the internal plugins to be processed first")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTOMATIC_PACKIN_RETRIES")),(0,l.kt)("td",{parentName:"tr",align:null},"When applying automatically a 2Pack, this defines the number of retries to wait for the semaphore when other plugins are applying 2Packs, this is used in combination with AUTOMATIC_PACKIN_TIMEOUT")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTOMATIC_PACKIN_TIMEOUT")),(0,l.kt)("td",{parentName:"tr",align:null},"When applying automatically a 2Pack, this defines the waiting time to try to get the semaphore when other plugins are applying 2packs, this is used in combination with AUTOMATIC_PACKIN_RETRIES")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"AUTOMATIC_PACKIN_PROCESSING")),(0,l.kt)("td",{parentName:"tr",align:null},"This key is used internally by the automatic application of 2Packs as a semaphore to indicate that another 2Pack is being applied, is not intended to be managed by the user, but automatically managed by the system.")))),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"-zip-file-naming-convention"},"\ud83e\udde9 ZIP File Naming Convention"),(0,l.kt)("p",null,"Files must follow this naming pattern:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"[Timestamp]_[ClientValue]_[OptionalInfo].zip\n")),(0,l.kt)("h4",{id:"naming-components"},"Naming Components"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Component"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Format"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Timestamp")),(0,l.kt)("td",{parentName:"tr",align:null},"Used to sort files chronologically"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"yyyymmddHHMM"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"ClientValue")),(0,l.kt)("td",{parentName:"tr",align:null},"Target client(s) for installation"),(0,l.kt)("td",{parentName:"tr",align:null},"See options below")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"OptionalInfo")),(0,l.kt)("td",{parentName:"tr",align:null},"Human-readable description"),(0,l.kt)("td",{parentName:"tr",align:null},"Any descriptive text")))),(0,l.kt)("h4",{id:"clientvalue-options"},"ClientValue Options"),(0,l.kt)("admonition",{title:"Client Targeting",type:"info"},(0,l.kt)("p",{parentName:"admonition"},"The ",(0,l.kt)("inlineCode",{parentName:"p"},"ClientValue")," component determines which client(s) will receive the 2Pack installation:")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"ClientValue"),(0,l.kt)("th",{parentName:"tr",align:null},"Behavior"),(0,l.kt)("th",{parentName:"tr",align:null},"Example"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SYSTEM")),(0,l.kt)("td",{parentName:"tr",align:null},"Install only on System client"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SYSTEM"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"[ClientName]")),(0,l.kt)("td",{parentName:"tr",align:null},"Install only on specific client"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GardenWorld"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ALL-CLIENTS")),(0,l.kt)("td",{parentName:"tr",align:null},"Install on all non-System clients"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ALL-CLIENTS"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ALL-CLIENTS-[SeedClient]")),(0,l.kt)("td",{parentName:"tr",align:null},"Install on seed client first, then all others"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"ALL-CLIENTS-GardenWorld"))))),(0,l.kt)("admonition",{title:"Multi-Client Deployments",type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"Use ",(0,l.kt)("inlineCode",{parentName:"li"},"ALL-CLIENTS")," when you want identical configurations across all tenants"),(0,l.kt)("li",{parentName:"ul"},"Use ",(0,l.kt)("inlineCode",{parentName:"li"},"ALL-CLIENTS-[SeedClient]")," when you need to establish UUID mappings for cross-client record references"))),(0,l.kt)("h3",{id:"-examples"},"\ud83d\udce6 Examples"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"201803161725_SYSTEM_CreateNewColumn.zip")," \u2192 Installs on System"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"201803161735_GardenWorld_CreateNewTax.zip")," \u2192 Just GardenWorld"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"201803161745_ALL-CLIENTS_CreateNewTax.zip")," \u2192 All non-System clients"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"201803161755_ALL-CLIENTS-GardenWorld_CreateNewTax.zip")," \u2192 GardenWorld first, then others")),(0,l.kt)("hr",null),(0,l.kt)("h3",{id:"seed-client-explained"},"Seed Client Explained"),(0,l.kt)("p",null,"When installing in ",(0,l.kt)("strong",{parentName:"p"},"ALL-CLIENTS"),", the seed client creates a UUID map. This allows:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Creating ",(0,l.kt)("strong",{parentName:"li"},"identical records")," across tenants  "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Updating")," records in other clients that originated in the seed client  ")),(0,l.kt)("p",null,"The mapping is stored in the ",(0,l.kt)("inlineCode",{parentName:"p"},"AD_Package_UUID_Map")," table."),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"flow-summary"},"Flow Summary"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Scans folders recursively for ",(0,l.kt)("inlineCode",{parentName:"li"},".zip")," files"),(0,l.kt)("li",{parentName:"ol"},"Sorts files by ",(0,l.kt)("strong",{parentName:"li"},"timestamp")),(0,l.kt)("li",{parentName:"ol"},"For each zip file:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Determines target client(s)"),(0,l.kt)("li",{parentName:"ul"},"Installs into each tenant"),(0,l.kt)("li",{parentName:"ul"},"Logs result in the ",(0,l.kt)("strong",{parentName:"li"},"Pack In")," window"))),(0,l.kt)("li",{parentName:"ol"},"Stops on error; remaining files will not be applied")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"email-notifications"},"Email Notifications"),(0,l.kt)("p",null,"To receive success/failure notifications:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Configure email settings on each tenant (Request EMail must be valid)"),(0,l.kt)("li",{parentName:"ul"},"Set the ",(0,l.kt)("inlineCode",{parentName:"li"},"EMAIL_NOTIFY_2PACK")," SysConfig key with one or more emails (comma-separated)")),(0,l.kt)("p",null,"Emails are sent ",(0,l.kt)("strong",{parentName:"p"},"per tenant")," and also for ",(0,l.kt)("strong",{parentName:"p"},"System")," if applicable."),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"-references"},"\ud83d\udcda References"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://idempiere.atlassian.net/browse/IDEMPIERE-3551"},"IDEMPIERE-3551")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://idempiere.atlassian.net/browse/IDEMPIERE-3660"},"IDEMPIERE-3660"))),(0,l.kt)("hr",null))}u.isMDXComponent=!0}}]);